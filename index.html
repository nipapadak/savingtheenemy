<!doctype html>
<html>
<head>
  <link rel="stylesheet" href="style.css">
  <script src="https://raw.github.com/mozilla/popcorn-js/master/popcorn.js"></script>
  <script src="https://raw.github.com/mozilla/popcorn-js/master/plugins/text/popcorn.text.js"></script>
</head>
<body>

<section id="step1" class="focused">
  <!--loop intro-->
  <!--webm of these videos?-->
  <div class="background">
    <img src="media/img/01_intro_title_01.png">
    <!--<video id="introLoop" src="media/vid/01_battlefield_trans.mp4"></video>-->
  </div>
  <div class="wrapper" id="titleWrapper">
    <h1>Saving the Enemy</h1>
    <p>(Prototype)</p>
    <!--button to kill loop, and go into q1-->
    <div class="button-wrapper">
      <button id="startQ1" class="dogtag"><span>Begin</span></button>
    </div>
  </div>
  <!--q1 video to bunker-->
  <div class="background">
    <video style="display:none;" id="q1video">
      <source src="media/vid/01.mp4">
      <source src="media/vid/01.webm">
    </video>
  </div>
  <!--3 blocks of text, 5 seconds each-->
  <div id="q1text"></div>
  <!--create popcorn text track events for q1 video-->
  <script>
    /*var pIntro = Popcorn("#introLoop");
    if ( pIntro.readyState() >= 4 ) {
      pIntro.currentTime(5);
    } else {
      pIntro.on("canplay", function() {
        pIntro.currentTime(5);
      });
    }*/

    var p = Popcorn("#q1video");
    p.text({
       start: 3,
       end: 11,
       target: "q1text",
       text: "There is a war going on between two enemy factions:<br/> army A and army B. John is a soldier with army A,<br/> Chris is a soldier with army B."
     })
     .text({
       start: 13,
       end: 21,
       target: "q1text",
       text: "John is given orders to go into army B's conquered bunker<br/> and kill remaining enemies, some of whom may still be armed. "
     });
  </script>
  <!--script to kill loop, and play q1 video-->
  <script>
    var startButton = document.getElementById("startQ1");
    startButton.addEventListener("click", function() {
      document.getElementById("titleWrapper").style.display="none";
      //var introVideo = document.getElementById("introLoop");
      //introVideo.style.display="none";
      var q1Video = document.getElementById("q1video");
      q1video.style.display="block";
      q1Video.play();
      q1Video.addEventListener("ended", function() {
        var q1Content = document.getElementById("q1Content");
        q1Content.style.display="block";
        $('#q1Content').find('.next').on('click', function() {
          document.getElementById("q2video").play();
        });
      }, false);
    }, false);
  </script>
  <!--q1 questions-->
  <div style="display: none;" class="qWrapper right" id="q1Content">
    <h2>If you were in his shoes, would you follow orders and go into the bunker, or escape now, knowing your safety would be guaranteed?</h2>
    <!--buttons send us off to question 2-->
    <div class="button-wrapper">
      <button class="dogtag next" value="yes"><span>Enter bunker</span></button>
      <button class="dogtag next" value="no"><span>Leave post</span></button>
    </div>
  </div>
</section>

<section id="step2">
  <div class="background">
    <video id="q2video">
      <source src="media/vid/02.mp4">
      <source src="media/vid/02.webm">
    </video>
  </div>
  <!--q2 question-->
  <div style="display: none;" class="qWrapper left" id="q2Content">
    <h2>John hears someone moving. Would you defend yourself and fire your rifle or hold fire approach further to investigate?</h2>
    <!--buttons send us off to question 3-->
    <div class="button-wrapper">
      <button class="dogtag next" value="no"><span>Shoot</span></button>
      <button class="dogtag next" value="yes"><span>Approach</span></button>
    </div>
  </div>
  <!--script to load question 2 video content when video finishes-->
  <script>
    document.getElementById("q2video").addEventListener("ended", function() {
      document.getElementById("q2Content").style.display="block";
      $('#q2Content').find('.next').on('click', function() {
        document.getElementById("q3video").play();
      });
    }, false);
  </script>
</section>

<section id="step3">
  <!--step three has a placeholder split nattative, it won't be functional but to show what it would do for demo purposes-->
  <div class="background">
    <video id="q3video">
      <source src="media/vid/03.mp4">
      <source src="media/vid/03.webm">
    </video>
  </div>
  <!--q3 question-->
  <div style="display: none;" class="qWrapper right" id="q3Content">
    <h2>John sees the wounded soldier. In this situation would you shoot the injured soldier now, or approach closer to investigate his injuries?</h2>
    <!--buttons send us off to question 4-->
    <div class="button-wrapper">
      <button class="dogtag next" value="yes"><span>Investigate</span></button>
      <button class="dogtag next" value="no"><span>Shoot</span></button>
    </div>
  </div>
  <!--script to load question 3 video content when video finishes-->
  <script>
    document.getElementById("q3video").addEventListener("ended", function() {
      document.getElementById("q3Content").style.display="block";
      $('#q3Content').find('.next').on('click', function() {
        document.getElementById("q4video").play();
      });
    }, false);
  </script>
</section>

<section id="step4">
  <div class="background">
    <video id="q4video">
      <source src="media/vid/04.mp4">
      <source src="media/vid/04.webm">
    </video>
  </div>
  <div class="wrapper" style="display: none;" id="splitWrapper">
    <h2>Switch to Chris' point of view or continue with John.</h2>
    <!--button to kill loop, and go into q1-->
    <div class="button-wrapper">
      <button id="chrisButton" class="dogtag"><span>Follow Chris</span></button>
      <button id="johnButton" class="dogtag"><span>Follow John</span></button>
    </div>
  </div>
  <script>
    var q4 = Popcorn("#q4video");

    // cue this time at the split.
    q4.cue( 4, function() {
      q4.pause();
      var splitWrapper = document.getElementById("splitWrapper");
      splitWrapper.style.display = "table-cell"
      document.getElementById("johnButton").addEventListener("click", function() {
        splitWrapper.style.display = "none";
        q4.play();
      }, false);
    });
  </script>
  <!--q4 question-->
  <div style="display: none;" class="qWrapper left" id="q4Content">
    <h2>Would you attempt to save this soldier and risk being killed for treason, or follow orders and kill him?</h2>
    <!--buttons send us off to question 5 a or b-->
    <div class="button-wrapper">
      <button data-next="step5-yes" class="dogtag next" value="yes"><span>Save him</span></button>
      <button data-next="step5-no" class="dogtag next" value="no"><span>Kill him</span></button>
    </div>
  </div>
  <!--script to load question 4 video content when video finishes-->
    <script>
        document.getElementById("q4video").addEventListener("ended", function() {
            document.getElementById("q4Content").style.display="block";
            $('#q4Content').find('.next').on('click', function() {

                if( this.value == "yes" ) {
                  document.getElementById("q5-yes-video").play();
                }else{
                  document.getElementById("q5-no-video").play();
                }
            });
        }, false);
    </script>

</section>

<section id="step5-yes">
    <!--<h2>Zehad helps Najah using his medical supplies.</h2>-->
    <div class="background">
        <video id="q5-yes-video" src="media/vid/01.mp4"></video>
    </div>
    <!--script to load question infographic-->
    <script>
        document.getElementById("q5-yes-video").addEventListener("ended", function() {
            $( "#step5-yes").removeClass('focused');
            $( "#step5-yes").addClass('completed');
            $( "#step6").addClass('focused');
        }, false);
    </script>
</section>


<section id="step5-no">
  <!--<h2>Najah was killed.</h2>-->
    <div class="background">
        <video id="q5-no-video" src="media/vid/01.mp4"></video>
    </div>
    <!--script to load question infographic-->
    <script>
        document.getElementById("q5-no-video").addEventListener("ended", function() {
            $( "#step5-no").removeClass('focused');
            $( "#step5-no").addClass('completed');
            $( "#step6").addClass('focused');
        }, false);
    </script>
</section>




<section id="step6">
    <!--Insert infographic HTML here-->
  <div class="background fadeout">
    <img src="media/img/01_intro_title_01.png">
  </div>
  <div class="stats-wrapper">
    <h2>People who decided to save Chris</h2>
    <div><em>* These are mock charts.</em></div>
    <div class="chart-wrapper">
      <p>by Region</p>
      <div id="chartdiv1" class="chart"></div>
    </div>
    <div class="chart-wrapper">
      <p>by Ethnicity</p>
      <div id="chartdiv2" class="chart"></div>
    </div>
    <div class="chart-wrapper">
      <p>by Religion</p>
      <div id="chartdiv3" class="chart"></div>
    </div>
  </div>
</section>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
<script src="ui.js"></script>
<script src="http://www.amcharts.com/lib/amcharts.js" type="text/javascript"></script>
<script src="infographic.js"></script>
</body>
</html>
